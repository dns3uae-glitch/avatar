<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>مسرح الجريمة 3D واقعي</title>
<style>
  body { margin:0; overflow:hidden; background:#111; }
  canvas { display:block; }
  .controls {
    position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
    display: grid; grid-template-areas: ". up ." "left . right" ". down ."; gap: 10px;
  }
  button {
    width: 50px; height: 50px; font-size: 18px; border:none;
    border-radius: 5px; background:#444; color:#fff; cursor:pointer;
  }
</style>
</head>
<body>

<div class="controls">
  <button id="up" style="grid-area: up;">↑</button>
  <button id="down" style="grid-area: down;">↓</button>
  <button id="left" style="grid-area: left;">←</button>
  <button id="right" style="grid-area: right;">→</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
<script>
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0x202020); // خلفية داكنة

  const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 50);
  camera.position.set(0,1.5,5);
  let cameraRotationY = 0;

  const renderer = new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  window.addEventListener('resize', ()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });

  // إضاءة واقعية
  const ambientLight = new THREE.AmbientLight(0xffffff,0.6);
  scene.add(ambientLight);

  const spotLight = new THREE.PointLight(0xffffff,0.8);
  spotLight.position.set(2,5,3);
  scene.add(spotLight);

  // الغرفة
  const floorMaterial = new THREE.MeshStandardMaterial({color:0x654321}); // خشبي داكن
  const wallMaterial = new THREE.MeshStandardMaterial({color:0x888888}); // رمادي فاتح
  const ceilingMaterial = new THREE.MeshStandardMaterial({color:0xffffff}); // أبيض

  const floor = new THREE.Mesh(new THREE.PlaneGeometry(10,10), floorMaterial);
  floor.rotation.x = -Math.PI/2; scene.add(floor);

  const backWall = new THREE.Mesh(new THREE.PlaneGeometry(10,5), wallMaterial);
  backWall.position.set(0,2.5,-5); scene.add(backWall);

  const leftWall = new THREE.Mesh(new THREE.PlaneGeometry(10,5), wallMaterial);
  leftWall.rotation.y = Math.PI/2; leftWall.position.set(-5,2.5,0); scene.add(leftWall);

  const rightWall = new THREE.Mesh(new THREE.PlaneGeometry(10,5), wallMaterial);
  rightWall.rotation.y = -Math.PI/2; rightWall.position.set(5,2.5,0); scene.add(rightWall);

  const ceiling = new THREE.Mesh(new THREE.PlaneGeometry(10,10), ceilingMaterial);
  ceiling.rotation.x = Math.PI/2; ceiling.position.y = 5; scene.add(ceiling);

  // أدوات الجريمة مع ألوان واقعية
  const knife = new THREE.Mesh(new THREE.BoxGeometry(0.15,0.02,0.5), new THREE.MeshStandardMaterial({color:0xaaaaaa}));
  knife.position.set(-1,0.05,1); scene.add(knife);

  const gun = new THREE.Mesh(new THREE.BoxGeometry(0.3,0.1,0.5), new THREE.MeshStandardMaterial({color:0x111111}));
  gun.position.set(1,0.05,-1); scene.add(gun);

  const glove = new THREE.Mesh(new THREE.SphereGeometry(0.2,16,16), new THREE.MeshStandardMaterial({color:0xffffff}));
  glove.position.set(0,0.2,0); scene.add(glove);

  const cup = new THREE.Mesh(new THREE.CylinderGeometry(0.2,0.2,0.3,16), new THREE.MeshStandardMaterial({color:0xffffff}));
  cup.position.set(0.5,0.15,0.5); scene.add(cup);

  // التحكم بالكاميرا
  const moveSpeed = 0.1;
  const rotateSpeed = 0.03;
  const keys = {up:false, down:false, left:false, right:false};

  document.getElementById('up').addEventListener('mousedown', ()=> keys.up=true);
  document.getElementById('up').addEventListener('mouseup', ()=> keys.up=false);
  document.getElementById('down').addEventListener('mousedown', ()=> keys.down=true);
  document.getElementById('down').addEventListener('mouseup', ()=> keys.down=false);
  document.getElementById('left').addEventListener('mousedown', ()=> keys.left=true);
  document.getElementById('left').addEventListener('mouseup', ()=> keys.left=false);
  document.getElementById('right').addEventListener('mousedown', ()=> keys.right=true);
  document.getElementById('right').addEventListener('mouseup', ()=> keys.right=false);

  window.addEventListener('keydown', e=>{
    if(e.key==='ArrowUp') keys.up=true;
    if(e.key==='ArrowDown') keys.down=true;
    if(e.key==='ArrowLeft') keys.left=true;
    if(e.key==='ArrowRight') keys.right=true;
  });
  window.addEventListener('keyup', e=>{
    if(e.key==='ArrowUp') keys.up=false;
    if(e.key==='ArrowDown') keys.down=false;
    if(e.key==='ArrowLeft') keys.left=false;
    if(e.key==='ArrowRight') keys.right=false;
  });

  function animate(){
    requestAnimationFrame(animate);

    if(keys.left) cameraRotationY += rotateSpeed;
    if(keys.right) cameraRotationY -= rotateSpeed;

    const dirX = Math.sin(cameraRotationY);
    const dirZ = Math.cos(cameraRotationY);

    if(keys.up){
      camera.position.x += dirX*moveSpeed;
      camera.position.z += dirZ*moveSpeed;
    }
    if(keys.down){
      camera.position.x -= dirX*moveSpeed;
      camera.position.z -= dirZ*moveSpeed;
    }

    camera.lookAt(camera.position.x+dirX, camera.position.y, camera.position.z+dirZ);

    renderer.render(scene,camera);
  }
  animate();
</script>
</body>
</html>
